package rentalserver;

import java.rmi.RemoteException;
import java.rmi.server.UnicastRemoteObject;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import shared.IVehicle;

/**
 * The vehicle implementation class.
 * @author Natacha
 *
 */
public class Vehicle extends UnicastRemoteObject implements IVehicle { 
	
	/**
	 * The serial version UID.
	 */
	private static final long serialVersionUID = 1L;
	
	/**
	 * The unique identifier of the vehicle.
	 */
	long uniqueId;
	
	/**
	 * The make of the vehicle (for example, Renault, Peugeot...)
	 */
	String make;
	
	/**
	 * The model of the vehicle (for example, Clio, 208...)
	 */
	String model;
	
	/**
	 * The year of production of the vehicle
	 */
	int year;
	
	/**
	 * The number of seats in the vehicle
	 */
	int seatingCapacity;
	
	/**
	 * The fuel type of the vehicle (diesel, gasoline, electric...)
	 */
	String fuelType;
	
	/**
	 * The transmission type of the vehicle (manual or automatic)
	 */
	String transmission;
	
	/**
	 * The price of the vehicle
	 */
	float priceInEuros;
	
	/**
	 * A boolean indicating availability of vehicle for rent
	 */
	boolean availableForRent;
	
	/**
	 * A boolean indicating availability of vehicle for sale
	 */
	boolean availableForSale;
	
	/**
	 * A list of integers between 0 and 10 indicating the satisfaction level of renters.
	 */
	List<Integer> notes;
	
	/**
	 * A list of Strings corresponding to the comments left by renters after returning a vehicle.
	 */
	List<String> conditions;
	

	/**
	 * Creates a default car (Renault, Clio of 2020, 5 seats, diesel, manual transmission, 18000 EUR).
	 * @param id the unique identifier of the vehicle
	 * @throws RemoteException may occur as this object will be used in remote method call.
	 */
	public Vehicle(long id) throws RemoteException {
		this.uniqueId = id;
		this.make = "Renault";
		this.model = "Clio";
		this.year = 2020;
		this.seatingCapacity = 5;
		this.fuelType = "Diesel";
		this.transmission = "Manual";
		this.priceInEuros = 18000;
		
		this.availableForRent = true;
		this.availableForSale = false;
		
		notes = new ArrayList<Integer>();
		conditions = new ArrayList<String>();
		
	}
	
	/**
	 * Creates a car with all the specified parameters.
	 * @param id the unique identifier of the vehicle
	 * @param make the make of the vehicle
	 * @param model the model of the vehicle
	 * @param year the year of production of the vehicle
	 * @param seatingCapacity the number of seats in the vehicle
	 * @param fuelType the fuel type of the vehicle
	 * @param transmission the transmission type of the vehicle
	 * @param priceInEuros the price in Euros for this vehicle
	 * @throws RemoteException may occur as this object will be used in remote method call.
	 */
	public Vehicle(long id, String make, String model, int year, int seatingCapacity, String fuelType, String transmission, float priceInEuros) throws RemoteException {
		this.uniqueId = id;
		this.make = make;
		this.model = model;
		this.year = year;
		this.seatingCapacity = seatingCapacity;
		this.fuelType = fuelType;
		this.transmission = transmission;
		this.priceInEuros = priceInEuros;
		
		this.availableForRent = true;
		this.availableForSale = false;
		
		notes = new ArrayList<Integer>();
		conditions = new ArrayList<String>();
	}
	
	@Override
	public long getId() throws RemoteException {
		return this.uniqueId;
	}

	@Override
	public void setId(long uniqueid) throws RemoteException {
		this.uniqueId = uniqueid;
	}

	@Override
	public String getMake() throws RemoteException {
		return this.make;
	}

	@Override
	public void setMake(String m) throws RemoteException {
		this.make = m;
	}

	@Override
	public String getModel() throws RemoteException {
		return this.model;
	}

	@Override
	public void setModel(String m) throws RemoteException {
		this.model = m;
	}

	@Override
	public int getYear() throws RemoteException {
		return this.year;
	}

	@Override
	public void setYear(int y) throws RemoteException {
		this.year = y;
	}

	@Override
	public int getSeatingCapacity() throws RemoteException {
		return this.seatingCapacity;
	}

	@Override
	public void setSeatingCapacity(int c) throws RemoteException {
		this.seatingCapacity = c;
	}

	@Override
	public String getFuelType() throws RemoteException {
		return this.fuelType;
	}

	@Override
	public void setFuelType(String s) throws RemoteException {
		this.fuelType = s;
	}

	@Override
	public String getTransmission() throws RemoteException {
		return this.transmission;
	}

	@Override
	public void setTransmission(String s) throws RemoteException {
		this.transmission = s;
	}

	@Override
	public float getPriceInEuros() throws RemoteException {
		return this.priceInEuros;
	}

	@Override
	public void setPriceInEuros(float price) throws RemoteException {
		this.priceInEuros = price;
	}
	
	@Override
	public boolean isAvailableForRent() throws RemoteException {
		return this.availableForRent;
	}

	@Override
	public boolean isAvailableForSale() throws RemoteException {
		return this.availableForSale;
	}

	@Override
	public void rentCar() throws RemoteException {
		this.availableForRent = false;
		this.availableForSale = true;
	}
	
	@Override
	public void returnCar(int note, String condition) throws RemoteException {
		this.availableForRent = true;
		
		notes.add(Integer.valueOf(note));
		conditions.add(condition);
	}

	@Override
	public String getLastCondition() throws RemoteException {
		if (conditions.size() > 0)
			return conditions.get(this.conditions.size() - 1);
		return "";
	}

	@Override
	public float getAverageNote() throws RemoteException {
		
		if (notes.size() == 0)
			return 0;
		
		int sum = 0;
		
		Iterator<Integer> it = notes.iterator();
		while (it.hasNext()) {
			sum += (int) it.next();
		}
		
		return sum/notes.size();
	}
	
	@Override
	public String getDisplayString() throws RemoteException {
		String displayString = "Vehicle ";
		displayString = displayString+" Make : "+getMake()+" Model : "+getModel();
		displayString = displayString+" Year : "+getYear()+" Seating places : "+getSeatingCapacity();
		displayString = displayString+" Fuel type :"+getFuelType()+" Transmission : "+getTransmission();
		displayString = displayString+" Price : "+getPriceInEuros();
		displayString = displayString+" Average note : "+getAverageNote();
		displayString = displayString+" Last comment : "+getLastCondition();
		
		return displayString;
	}
	

}